<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio de Julien Michelin</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>
    <link rel="stylesheet" href="./../style.css">
</head>
<body>
    <header>
        <nav class="navbar navbar-expand-lg sticky-top navbar-dark bg-dark py-3 px-3">
            <div class="container-fluid">
                <button
                    class="navbar-toggler"
                    type="button"
                    data-bs-toggle="offcanvas"
                    data-bs-target="#offcanvasNavbar"
                    aria-controls="offcanvasNavbar"
                    aria-label="Toggle navigation"
                >
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="logo">
                    <img src ="./../portfolio.jpg" alt = "logo" width="200" height ="100" class="img-fluid" style="max-width: 150px;"/>
                </div>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link" href="./../index.html">Accueil</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="./../skill.html">Skills üöß</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="./../../proj.html">Projets üöß</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page" href="./../stages.html">Stages</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="./../propos.html">√Ä propos üöß</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <div
            class="offcanvas offcanvas-start text-bg-dark"
            tabindex="-1"
            id="offcanvasNavbar"
            aria-labelledby="offcanvasNavbarLabel"
        >
            <div class="offcanvas-header">
                <h5 class="offcanvas-title" id="offcanvasNavbarLabel">Menu</h5>
                <button
                    type="button"
                    class="btn-close btn-close-white"
                    data-bs-dismiss="offcanvas"
                    aria-label="Close"
                ></button>
            </div>
            <div class="offcanvas-body">
                <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
                    <li class="nav-item">
                        <a class="nav-link text-white" href="./../index.html">Accueil</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-white" href="./../skill.html">Skills üöß</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-white" href="./../proj.html">Projets üöß</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active text-white"  aria-current="page" href="./../stages.html">Stages</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-white" href="./../propos.html">√Ä propos üöß</a>
                    </li>
                </ul>
            </div>
        </div>
    </header>

    <main>
        <section id="mission-detaille" class="hero-section py-5 bg-light text-dark text-center">
            <div class="container my-5">
                <h1 class="display-4 text-dark mb-3">Missions accomplies</h1>
                <h2 class="display-6 text-secondary mb-5">Liste des diff√©rentes missions avec productions associ√©es</h2>
                <ul class="list-group list-group-flush text-start">
                    <li class="list-group-item d-flex align-items-center mb-3 border rounded shadow-sm p-3">
                        <span class="badge bg-primary rounded-pill me-3 p-2">1</span>
                        Documentation et Support Utilisateur : Cr√©ation de guides utilisateurs et de documentations techniques pour faciliter l'autonomie et la compr√©hension des processus.
                    </li>
                    <!-- D√©tail de mission-->
                    
                        <p>J'ai document√© plusieurs petites missions que j'ai d√ª faire et j'ai aussi fait un compte rendu hebdomadaire, que vous retrouverez ci-dessous.</p>
                        
                        <a href="https://siovhblyceebasch-my.sharepoint.com/:f:/g/personal/julien_michelin_lycee-basch_fr/EkiHOl6pIDdGt_br2fOwZ3wB5-q5TumOxCpzMTQMOSZ9sw?e=51zEuc"
                            class="btn btn-primary btn-lg mx-2 mb-2 rounded-pill fw-bold">Documentations techniques & comptes rendus</a>
                        
                        <p>Suite aux services que j'ai d√©ploy√©s ou d√©velopp√©s, j'ai produit plusieurs documentations utilisateur. Vous les retrouverez ci-dessous.</p>
                        
                        <a href="https://siovhblyceebasch-my.sharepoint.com/:f:/g/personal/julien_michelin_lycee-basch_fr/EqLAPiUc7aRMm3Brsy2h8RsBvB02nRt2mY-pXwQLiiYQWw?e=ISVL6F"
                            class="btn btn-primary btn-lg mx-2 mb-2 rounded-pill fw-bold">Guides utilisateurs</a>

                        <p>J'ai aussi √©t√© amen√© √† cr√©er une charte informatique car ils n'en avaient pas ; vous la retrouverez ci-dessous.</p>
                        
                        <a href="https://siovhblyceebasch-my.sharepoint.com/:f:/g/personal/julien_michelin_lycee-basch_fr/EqLAPiUc7aRMm3Brsy2h8RsBvB02nRt2mY-pXwQLiiYQWw?e=ISVL6F"
                            class="btn btn-primary btn-lg mx-2 mb-2 rounded-pill fw-bold">Charte informatique</a>
                    </div>
                    <li class="list-group-item d-flex align-items-center mb-3 border rounded shadow-sm p-3">
                        <span class="badge bg-primary rounded-pill me-3 p-2">2</span>
                        D√©veloppement Web et Automatisation : Conception et d√©veloppement d'une application web pour l'int√©gration automatique de contacts via un fichier tableur dans l'outil de gestion des emails (Brevo).
                    </li>
                    <!-- D√©tail de mission-->
                        <div class="mb-4 text-center">
                            <p>Sur demande de l'association, j'ai cr√©√© une application web qui utilise l'API de Brevo afin d'ajouter des contacts qui sont pr√©sents dans un tableur.
                               Ce tableur a des colonnes dont les noms ne changent pas, ce qui m'a permis de faire un code qui ne fonctionne qu'avec ce tableur sp√©cifiquement.
                                Cependant, ce projet n'a pas √©t√© publi√© car un nouveau projet a vu le jour juste apr√®s, et donc ils n'ont plus eu besoin de mon application web. N√©anmoins, vous pouvez d√©ployer le projet en local.
                            </p>
                            <p>Ci-dessous, vous retrouverez le d√©p√¥t GitHub associ√© √† ce projet.</p>
                            
                            <a href="https://github.com/jujumichl/CCR_brevo"
                            class="btn btn-primary btn-lg mx-2 mb-2 rounded-pill fw-bold">D√©p√¥t Brevo sur GitHub</a>
                        </div>
                    <li class="list-group-item d-flex align-items-center mb-3 border rounded shadow-sm p-3">
                        <span class="badge bg-primary rounded-pill me-3 p-2">3</span>
                        Gestion de Projet et Conception Applicative : Initialisation et structuration d'un projet d'application web destin√© √† la gestion des adh√©rents de l'association.
                    </li>
                    <!-- D√©tail de mission-->
                     <div class="mb-4 text-center">
                     <p>C'est donc ce projet qui a vu le jour a la suite du d√©veloppement de l'application web concernant Brevo. 
                        Ce projet est un projet qui r√©pond a une r√©elle demande des salari√©s du cerlce celtique. 
                        Ils n'avaient pas de logiciel de gestion des adh√©rents.
                        Dominique qui s'occupe du d√©veloppement informatique du cercle celtique de rennes avait d√©j√† penser auparavant a d√©velopper une application web de gestin des adh√©rents 
                        cependant il ne souhaitait pas trop s'avancer il a donc attendu que la demande vienne r√©ellement. J'ai donc permit au projet de se r√©aliser,
                        a la fin de mon stage nous avons pu d√©ployer la V1 du site.
                     </p>
<!----------------------------------------------------------------------------- Ajout de bout de code !!!!----------------------------------------------------------------------------->
                    <div class="card mt-4" style="max-width: 900px; margin-left: auto; margin-right: auto;"> 
                        <div class="card-header">
                            J'ai travaill√© principalement sur le fichier integrationCSV, o√π j'ai √©t√© charg√© de mettre en place les fonctions de chargement et d'impl√©mentation du contenu du fichier, ainsi que de sa v√©rification.
                        </div>
                        <div class="card-body text-start" style="max-height: 400px; overflow-y: auto;"> 
                            <pre><code class="PHP" style="overflow-x: auto; white-space: pre;">
//Voici les diff√©rentes fonctions que j'ai cod√©es :
&lt;?php


/**************** CONTROLLER ****************************** */
/**
 * Controller for the Selection page
 */
function upload() {
    $target_dir = "./src/integrationCSV/fichier";

    $tmp_name = $_FILES["fileToUpload"]["tmp_name"];
    $type = array("csv");
    $csvFileType = strtolower(pathinfo($_FILES["fileToUpload"]["name"],PATHINFO_EXTENSION));
    //named the file with the year, month, day and hour, minute and seconde
    $target_file = $target_dir . date('YmdHis') . '.' . $csvFileType;
    // Check if CSV file is a actual CSV or fake CSV
    if (is_uploaded_file($tmp_name) && in_array($csvFileType, $type)){
        move_uploaded_file($_FILES["fileToUpload"]["tmp_name"], $target_file);
        return $target_file;
    }
    else {
        throw new Exception("Veuillez v√©rifier le que vous avez bien exporter votre fichier au format CSV encoder en UTF-8.");
    }
}
$csvPath = upload();
$nomFichier = $_FILES["fileToUpload"]["name"];
$resultat = CSVToSQL($csvPath,  'brouillon', $pdo);
$msgErr = parseAndStoreData($pdo);
/**************** MODEL ****************************** */
/* 
 * Get data in csv file, add all data which we need in our database and stores them
 */


/**
 * make all data who are in csv file into the database selected
 * @param string $cheminFichierCSV path of csv file
 * @param string $nomBdd name of database
 * @param string $nomTable name of table
 * @throws \Exception if our data aren't in our database
 * @return array the content of our database
 */
function CSVToSQL($cheminFichierCSV, $nomTable, $pdo){
    if (!file_exists($cheminFichierCSV)) {
        die("Fichier introuvable : $cheminFichierCSV");
    }

    $handle = fopen($cheminFichierCSV, 'r');
    $entetes = fgetcsv($handle, 0, ';');
    $separateur = ';';

    // Try again with ',' if bad format
    if (!$entetes || count($entetes) &lt; 3) {
        fclose($handle);
        $handle = fopen($cheminFichierCSV, 'r');
        $entetes = fgetcsv($handle, 0, ',');
        $separateur = ',';
    }

    // Cleaning headers
    $entetes = array_map(function ($col) {
        return trim(preg_replace('/^\xEF\xBB\xBF/', '', $col));
    }, $entetes);

    // Location of key columns
    $emailKey = null;
    $telKey = null;
    $portKey = null;
    $nomKey = null;
    $prenomKey = null;
    $commKey = null;
    $adhKey = null;
    $actKey = null;
    $regKey = null;
    $codeKey = null;
    $CPKey = null;
    $annKey = null;
    $DadhKey = null;
    $naissKey = null;
    $titreKey = null;

    foreach ($entetes as $col) {
        $colUpper = strtoupper(trim($col));
        if (in_array($colUpper, ['NOM'])) $nomKey = $col;
        if (in_array($colUpper, ['PR√©NOM'])) $prenomKey = $col;
        if (in_array($colUpper, ['PORTABLE'])) $portKey = $col;
        if (in_array($colUpper, ['COURRIEL'])) $emailKey = $col;
        if (in_array($colUpper, ['COMMUNE'])) $commKey = $col;
        if (in_array($colUpper, ['MONTANT ADH'])) $adhKey = $col;
        if (in_array($colUpper, ['MONTANT ACT'])) $actKey = $col;
        if (in_array($colUpper, ['R√®GLEMENT'])) $regKey = $col;
        if (in_array($colUpper, ['CODE'])) $codeKey = $col;
        if (in_array($colUpper, ['CODE POSTAL'])) $CPKey = $col;
        if (in_array($colUpper, ['ANN√©E'])) $annKey = $col;
        if (in_array($colUpper, ['DATE D\'ADH√©SION'])) $DadhKey = $col;
        if (in_array($colUpper, ['DATE DE NAISSANCE'])) $naissKey = $col;
        if (in_array($colUpper, ['TITRE'])) $titreKey = $col;
        if (in_array($colUpper, ['T√©L√©PHONE'])) $telKey = $col;

    }
    
    if (!$emailKey) {
        throw new Exception("Colonne courriel introuvable");
    }
    //Drop and create table brouillon
    $sql = "drop table brouillon";
    $stmt = $pdo-&gt;prepare($sql);
    $stmt-&gt;execute();
    $sql = "CREATE TABLE IF NOT EXISTS `brouillon`(
        `brou_id` int,
        `brou_nom` varchar(255),
        `brou_prenom` varchar(255),
        `brou_portable` char(10),
        `brou_email` varchar(255),
        `brou_commune` varchar(255),
        `brou_adh` float,
        `brou_act` float,
        `brou_reglement` char(3),
        `brou_code` varchar(255),
        `brou_CP` varchar(255),
        `brou_annee` char(9),
        `brou_date_adh` char(10),
        `brou_date_naiss`char(10),
        `brou_titre` varchar(255),
        `brou_telephone` char(10)
    );";
    $stmt = $pdo-&gt;prepare($sql);
    $stmt-&gt;execute();

    //Treatment of data
    while (($ligne = fgetcsv($handle, 0, $separateur)) !== false) {
        
        $data = array_combine($entetes, $ligne);
        $nom = trim(preg_replace( '/^\xEF\xBB\xBF/', '', $data[$nomKey] ?? ''));
        $prenom = trim(preg_replace('/^\xEF\xBB\xBF/', '', $data[$prenomKey] ?? ''));
        $port = formatPhoneNumber($data[$portKey]);
        $email = trim(preg_replace('/^\xEF\xBB\xBF/', '', $data[$emailKey] ?? ''));
        $commune = trim(preg_replace('/^\xEF\xBB\xBF/', '', $data[$commKey] ?? ''));
        $adh = trim(preg_replace('/^\xEF\xBB\xBF/', '', $data[$adhKey] ?? ''));
        $act = trim(preg_replace('/^\xEF\xBB\xBF/', '', $data[$actKey] ?? ''));
        $reg = trim(preg_replace('/^\xEF\xBB\xBF/', '', $data[$regKey] ?? ''));
        $code = trim(preg_replace('/^\xEF\xBB\xBF/', '', $data[$codeKey] ?? ''));
        $CP = trim(preg_replace('/^\xEF\xBB\xBF/', '', $data[$CPKey] ?? ''));
        $annee = trim(preg_replace('/^\xEF\xBB\xBF/', '', $data[$annKey] ?? ''));
        $Dadh = trim(preg_replace('/^\xEF\xBB\xBF/', '', $data[$DadhKey] ?? ''));
        $naiss = trim(preg_replace('/^\xEF\xBB\xBF/', '', $data[$naissKey] ?? ''));
        $titre = trim(preg_replace('/^\xEF\xBB\xBF/', '', $data[$titreKey] ?? ''));
        $tel = formatPhoneNumber($data[$telKey]);
        
        if ($nom !== ''){
            $sql = "INSERT INTO $nomTable(
            brou_nom,
            brou_prenom,
            brou_portable,
            brou_email,
            brou_commune,
            brou_adh,
            brou_act,
            brou_reglement,
            brou_code,
            brou_CP,
            brou_annee,
            brou_date_adh,
            brou_date_naiss,
            brou_titre,
            brou_telephone
            ) Values (
            :nom,
            :prenom,
            :portable,
            :email,
            :commune,
            :adh,
            :act,
            :reglement,
            :code,
            :cp,
            :annee,
            :date_adh,
            :date_naiss,
            :titre,
            :telephone)";
            $stmt = $pdo-&gt;prepare($sql);
            $stmt-&gt;execute([
                ':nom' =&gt; $nom,
                ':prenom' =&gt; $prenom,
                ':portable' =&gt; $port,
                ':email' =&gt; $email,
                ':commune' =&gt; $commune,
                ':adh' =&gt; $adh,
                ':act' =&gt; $act,
                ':reglement' =&gt; $reg,
                ':code' =&gt; $code,
                ':cp' =&gt; $CP,
                ':annee' =&gt; $annee,
                ':date_adh' =&gt; $Dadh,
                ':date_naiss' =&gt; $naiss,
                ':titre' =&gt; $titre,
                ':telephone' =&gt; $tel
            ]);
        }
    }
    fclose($handle);
    // Check if it's an sucess
    if ($stmt-&gt;rowCount() &gt; 0) {
        $sql = "select * from brouillon";
        $stmt = $pdo-&gt;prepare($sql);
        $stmt-&gt;execute();
        $result = $stmt-&gt;fetchAll(\PDO::FETCH_ASSOC);
        unlink($cheminFichierCSV);
        return $result;
    } else {
        throw new Exception("Erreur lors du passage de donn√©es, veuillez v√©rifier le fichier ainsi que le nom des colonnes de ce fichier.");
    }
}





/**
 * store data
 * @param mixed $pdo pdo connexion
 * @return string
 *   $data = Array (
 *       [0] =&gt; Array ( 
 *           [brou_id] =&gt; ...............................................
 *           [brou_nom] =&gt; ...............................................
 *           [brou_prenom] =&gt; ...............................................
 *           [brou_portable] =&gt; ...............................................
 *           [brou_email] =&gt; ...............................................
 *           [brou_commune] =&gt; ...............................................
 *           [brou_adh] =&gt; ...............................................
 *           [brou_act] =&gt; ...............................................
 *           [brou_reglement] =&gt; ...............................................
 *           [brou_code] =&gt; ...............................................
 *           [brou_CP] =&gt; ...............................................
 *           [brou_annee] =&gt; ...............................................
 *           [brou_date_adh] =&gt; ...............................................
 *           [brou_date_naiss] =&gt; ...............................................
 *           [brou_titre] =&gt; ...............................................
 *           [brou_telephone] =&gt; ..............................................
 *           )
 *       ) 
 */
function parseAndStoreData($pdo){
    (string)$message = "";
    $data = null;
    //$count=0;
    //$count1=0;
    $sql = "select brou_email, count(*) AS tot from brouillon group by brou_email";
    $stmt = $pdo-&gt;prepare($sql);
    $stmt-&gt;execute();
    $result = $stmt-&gt;fetchAll(\PDO::FETCH_ASSOC);
    foreach ($result as $res){
        try{
            // check email
            if (filter_var($res['brou_email'], FILTER_VALIDATE_EMAIL)) {
                //$count++;  //601
                $sql = "select * from brouillon where brou_email = :mail";
                $stmt = $pdo-&gt;prepare($sql);
                $stmt-&gt;execute([
                    ':mail' =&gt; $res['brou_email']
                ]);
                $data = $stmt-&gt;fetchAll(\PDO::FETCH_ASSOC);
                //$res = Array ( [brou_email] =&gt; - [tot] =&gt; 17 )
                //Return the good ID of person
                $per_id = createPers($data[0], $pdo);

                
                
                if ($res['tot'] === 1){
                    ///////////////////////////////////////////////////////////////////////////////////////////////////////////
                    if ($data[0]['brou_code'] !== ''){
                        createAct($data[0],$per_id, $pdo);
                    }
                    if ($data[0]['brou_adh']&gt;0){
                        $data[0]['codeADH'] = 'AUT01';
                        createSubscription($data[0],$per_id, $pdo);
                    }
                }
                else {
                    multipleLignesComput($data, $per_id, $pdo);
                    //$count1++;  //85
                }
            }
            else {
                throw new Exception("Email invalide " . $res['brou_email']);
            }
        }catch (Exception $e){
            if ($data !== null){
                $message .= "Erreur : " . $e-&gt;getMessage() . ' -- ' . $data[0]['brou_nom']."&lt;/br&gt;";
            }
            else {
                $message .= "Erreur : " . $e-&gt;getMessage() ."&lt;/br&gt;";
            }
        }
    }
    //echo $count . "/" . $count1;
    return $message;
}

/**
 * use to create only one people
 * @param mixed $result data of people
 * @param mixed $pdo pdo connexion
 * @return mixed 
 */
function createPers($data, $pdo){
    //check if person isn't in db
    $sql = 'SELECT per_id FROM personnes WHERE per_email = :email';
    $stmt = $pdo-&gt;prepare($sql);
    $stmt-&gt;execute([
        ':email' =&gt; $data['brou_email']
    ]);
    $per_id = $stmt-&gt;fetchAll(\PDO::FETCH_ASSOC);
    //if not in
    if (count($per_id) &lt; 1) {
        if ($data['brou_titre'] === 'Madame'){
            $data['brou_titre'] = 2;
        }
        else if ($data['brou_titre'] === 'Monsieur'){
            $data['brou_titre'] = 1;
        }
        //$data = just array of data cf $result
        $sql = "INSERT INTO `personnes`(
        per_nom,
        civ_id,
        per_prenom,
        per_tel,
        per_email,
        per_code_postal,
        per_ville,
        per_dat_naissance
        )
        Values (
        :nom,
        :civ,
        :prenom,
        :tel,
        :mail,
        :cp,
        :ville,
        :naiss)
        ";
        $stmt = $pdo-&gt;prepare($sql);
        $stmt-&gt;execute([
            ':nom'=&gt;$data['brou_nom'],
            ':civ'=&gt;$data['brou_titre'],
            ':prenom'=&gt;$data['brou_prenom'],
            ':tel'=&gt;$data['brou_portable'],
            ':mail'=&gt;$data['brou_email'],
            ':cp'=&gt;$data['brou_CP'],
            ':ville'=&gt;$data['brou_commune'],
            ':naiss'=&gt;$data['brou_date_naiss']
        ]);
        $per_id = $pdo-&gt;lastInsertId();
        return $per_id;
    }
    else{
        return $per_id[0]['per_id'];
    }
}

/**
 * create one subscription
 * @param array $data data of createPers
 * @param mixed $pdo PDO connexion
 * @return void
 */
function createSubscription($data, $per_id, $pdo){
    $act_id = getIDActivity($data['codeADH'], $pdo);
    $reg_id = getamout(
        $per_id,
        $data['brou_adh'],
        $data['brou_act'],
        $data['brou_date_adh'],
        $data['brou_reglement'],
        $pdo);
    $sql = 'INSERT INTO `inscriptions`(
        per_id,
        act_id,
        ins_date_inscription,
        reg_id,
        ins_debut,
        ins_fin,
        ins_montant
        )VALUES(
        :per_id,
        :act_id,
        :ins_date_inscription,
        :reg_id,
        :ins_debut,
        :ins_fin,
        :ins_montant
    )
    ';
    $stmt = $pdo-&gt;prepare($sql);
    $dateAdh = stringToDate(
            substr($data['brou_date_adh'], 0,-8),
            substr($data['brou_date_adh'], 3, -5),
            substr($data['brou_date_adh'], -4));
    $stmt-&gt;execute([
        ':per_id' =&gt; $per_id,
        ':act_id' =&gt; $act_id,
        ':ins_date_inscription' =&gt; $dateAdh,
        ':reg_id' =&gt; (int)$reg_id,
        ':ins_debut' =&gt; $dateAdh,
        ':ins_fin' =&gt; getEndOfSeasonDate($dateAdh),
        ':ins_montant' =&gt; $data['brou_adh']
    ]);
}

/**
 * Create one activity
 * @param mixed $data data of createPers
 * @param mixed $pdo PDO connexion
 * @return void
 */
function createAct($data, $per_id, $pdo){
    $act_id = getIDActivity($data['brou_code'], $pdo);
    $reg_id = getamout(
        $per_id,
        $data['brou_adh'],
        $data['brou_act'],
        $data['brou_date_adh'],
        $data['brou_reglement'],
        $pdo);

    $sql = 'INSERT INTO `inscriptions`(
    per_id,
    act_id,
    ins_date_inscription,
    reg_id,
    ins_debut,
    ins_fin,
    ins_montant
    )VALUES(
    :per_id,
    :act_id,
    :ins_date_inscription,
    :reg_id,
    :ins_debut,
    :ins_fin,
    :ins_montant
    )
    ';
    $stmt = $pdo-&gt;prepare($sql);
    $dateAdh = stringToDate(
            substr($data['brou_date_adh'], 0,-8),
            substr($data['brou_date_adh'], 3, -5),
            substr($data['brou_date_adh'], -4));
    $stmt-&gt;execute([
        ':per_id' =&gt; $per_id,
        ':act_id' =&gt; $act_id,
        ':ins_date_inscription' =&gt; $dateAdh,
        ':reg_id' =&gt; (int)$reg_id,
        ':ins_debut' =&gt; $dateAdh,
        ':ins_fin' =&gt; getEndOfSeasonDate($dateAdh),
        ':ins_montant' =&gt; $data['brou_act']
    ]);
}

function getIDActivity($code, $pdo){
    //Get id of activity
    $sql = 'select act_id from activites where act_ext_key = :code';
    $stmt = $pdo-&gt;prepare($sql);
    $stmt-&gt;execute([
        ':code'=&gt; $code
        ]);
    $act_id = $stmt-&gt;fetchAll(\PDO::FETCH_ASSOC);
    return $act_id[0]['act_id'];
}

function getIdPerson($email, $pdo){
//Get id of person
    $sql = 'select per_id from personnes where per_nom = :email';
    $stmt = $pdo-&gt;prepare($sql);
    $stmt-&gt;execute([
        ':email'=&gt; $email
        ]);
    $per_id = $stmt-&gt;fetchAll(\PDO::FETCH_ASSOC);
    return $per_id[0]['per_id'];
}



/** 
 * Create one payment
 * @param $montant_adh amount of one subscription
 * @param $montant_act amount of an activity performed
 * @param $date_adh date of subscription
 * @param $mreg method of payment
 * @param $per_id id of one person
 * @para $pdo pdo connexion which is returned by function init_pdo
 * @return return id of last payment created
 */
function createPayment($montant_adh, $montant_act, $dateAdh, $mreg, $per_id, $pdo){
    $sql = 'select mreg_id from modereglement where mreg_code = :mreg';
    $stmt = $pdo-&gt;prepare($sql);
    $stmt-&gt;execute([ ':mreg' =&gt; $mreg]);
    $mregID = $stmt-&gt;fetchAll(\PDO::FETCH_ASSOC);
    $total = (int)$montant_act + (int)$montant_adh;
    if (!$mregID[0]['mreg_id']) {
        return "Mod√®le de r√®glement non connu ou invalide." . $per_id;
    }
    else {
        $sql = 'INSERT INTO reglements(
        `reg_montant`,
        `mreg_id`,
        `reg_date`
        )
        VALUES(
        :total,
        :mregid,
        :dateAdh
        )';
        $stmt = $pdo-&gt;prepare($sql);
        $stmt-&gt;execute([
            ':total' =&gt; $total,
            ':mregid'=&gt; $mregID[0]['mreg_id'],
            ':dateAdh' =&gt; $dateAdh
        ]);
        $reg_id = $pdo-&gt;lastInsertId();
        return $reg_id;
    }
}



/**
 * Get reg_id and check if he is already inside db or not, add it if not
 * @param int $per_id
 * @param int $montant_adh
 * @param int $montant_act
 * @param string $dateAdh
 * @param string $mreg
 * @param mixed $pdo
 */
function getamout($per_id, $montant_adh, $montant_act, $dateAdh, $mreg, $pdo){
    $sql = 'select reg_id from inscriptions where per_id = :id';
    $stmt = $pdo-&gt;prepare($sql);
    $stmt-&gt;execute([':id' =&gt; $per_id]);
    $amoutid = $stmt-&gt;fetchAll(\PDO::FETCH_ASSOC);

    // If $amoutid is empty, it means no registration was found, so create a new payment.
    if (empty($amoutid)){
        return createPayment(
            $montant_adh,
            $montant_act,
            $dateAdh,
            $mreg,
            $per_id,
            $pdo
        );
    }
    // If $amoutid is NOT empty, it means a registration was found, so return its reg_id.
    else {
        // print json_encode($amoutid[0]['reg_id']) . '&lt;br&gt;';
        return $amoutid[0]['reg_id'];
    }
}

/**
 * use to process multiple lines
 * @param mixed $person data on one person
 * @param mixed $pdo pdo connexion
 * @return void
 * FONCTION EN COURS DE DEVELOPPEMENT
 */
function multipleLignesComput($person, $per_id, $pdo){
    if (count($person)){}
}

                            </code></pre>
                        </div>
                    </div>   
                    <p>Ci-dessous, vous retrouverez l'ensemble d√©p√¥t GitHub associ√© √† ce projet.</p>
                     <a href="https://github.com/jujumichl/adhesion"
                            class="btn btn-primary btn-lg mx-2 mb-2 rounded-pill fw-bold">D√©p√¥t du projet sur GitHub</a>
                     </div>

                    <li class="list-group-item d-flex align-items-center mb-3 border rounded shadow-sm p-3">
                        <span class="badge bg-primary rounded-pill me-3 p-2">4</span>
                        Cybers√©curit√© et Sensibilisation : Pr√©paration et animation de sessions de formation aux bonnes pratiques de cybers√©curit√© pour sensibiliser les membres de l'√©quipe.
                    </li>
                    <!-- D√©tail de mission-->
                     <div class="mb-4 text-center">
                        <p>Quand je suis arriv√© dans cette association, j'ai vu le mat√©riel informatique utilis√© ainsi que les s√©curit√©s qui √©taient mises en place. 
                            J'ai tout de suite pens√© √† faire une petite formation aux salari√©s sur l'importance de la cybers√©curit√©.</p>
                        <p>Pendant mon stage, ils ont √©t√© pirat√©s. Le pirate a usurp√© leur identit√© pour r√©cup√©rer le montant d'une facture en changeant le RIB sur cette derni√®re. Le cercle 
                            celtique s'est rendu compte qu'ils avaient √©t√© pirat√©s car le pr√©sident √©tait en copie des mails. Le pirate a bien √©t√© retrouv√©.
                        </p>
                        <p>Retrouvez ci-dessous le support que j'ai utilis√© pour former les salari√©s du Cercle Celtique de Rennes
                        </p>
                        <a href="https://www.canva.com/design/DAGooSQw_E0/Ana-fJeEHgvV31UPP6nByA/edit?utm_content=DAGooSQw_E0&utm_campaign=designshare&utm_medium=link2&utm_source=sharebutton"
                                class="btn btn-primary btn-lg mx-2 mb-2 rounded-pill fw-bold">Support de formation utilis√©</a>
                    </div>
                    <li class="list-group-item d-flex align-items-center mb-3 border rounded shadow-sm p-3">
                        <span class="badge bg-primary rounded-pill me-3 p-2">5</span>
                        Maintenance et Administration R√©seau : Ex√©cution de t√¢ches de maintenance r√©seau , configuration d'√©quipements WiFi et la gestion des proc√©dures de sauvegarde de donn√©es.
                    </li>
                    <div class="mb-4 text-center">
                    <!-- D√©tail de mission-->
                        <p>√Ä mon arriv√©e, on m'a demand√© de trouver comment avoir acc√®s √† leur serveur de sauvegarde, un NAS de Synology.</p>
                        <p>On m'a expliqu√© que depuis le d√©part de l'ancien stagiaire qui l'avait mis en place, ils n'avaient plus acc√®s 
                            au NAS au bout de 2 semaines, et ne savaient pas si la sauvegarde √©tait toujours en marche.</p>
                        <p>J'ai donc r√©ussi √† me connecter gr√¢ce au guide laiss√© par l'ancien stagiaire et je leur ai remis le service
                             en marche. J'ai ensuite repris la documentation du stagiaire.</p>
                        <p>On m'a aussi demand√© de faire un comparatif entre leur serveur cloud et le serveur NAS dans l'optique d'inverser les fonctions des deux serveurs.</p>
                        <p>Vous retrouverez la documentation ci-dessous.</p>

                        <a href="https://siovhblyceebasch-my.sharepoint.com/:f:/g/personal/julien_michelin_lycee-basch_fr/EkiHOl6pIDdGt_br2fOwZ3wB5-q5TumOxCpzMTQMOSZ9sw?e=51zEuc"
                                class="btn btn-primary btn-lg mx-2 mb-2 rounded-pill fw-bold">Documentation li√©e</a>
                    </div>
                </ul>
            </div>
            <a href="javascript:history.back()" class="back-arrow">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left">
                    <line x1="19" y1="12" x2="5" y2="12"></line>
                    <polyline points="12 19 5 12 12 5"></polyline>
                </svg>
                Retour
            </a>  
        </section>
    </main>
            

    <footer class="bg-dark text-white py-4">
        <div class="container text-center">
            <div class="row">
                <div class="col-md-4 mb-3">
                    <h5 class="fw-bold mb-3">Contact</h5>
                    <ul class="list-unstyled">
                        <li><a href="tel:+33749178461" class="text-white-50 text-decoration-none">07 49 17 84 61</a> </li>
                        <li><a href="mailto:julienmichelin35@gmail.com" class="text-white-50 text-decoration-none">julienmichelin35@gmail.com</a> </li>
                        <li class="text-white-50">Melesse, 35520, France </li>
                    </ul>
                </div>
                <div class="col-md-4 mb-3">
                    <h5 class="fw-bold mb-3">Menu</h5>
                    <ul class="list-unstyled">
                        <li><a href="./../index.html" class="text-white-50 text-decoration-none">Accueil</a></li>
                        <li><a href="./../skill.html" class="text-white-50 text-decoration-none">Skills</a></li>
                        <li><a href="./../proj.html" class="text-white-50 text-decoration-none">Projets</a></li>
                        <li><a href="./../stages.html" class="text-white-50 text-decoration-none">Stages</a></li>
                        <li><a href="./../propos.html" class="text-white-50 text-decoration-none">√Ä propos</a></li>
                    </ul>
                </div>
                <div class="col-md-4 mb-3">
                    <h5 class="fw-bold mb-3">Suivez-moi</h5>
                    <ul class="list-unstyled">
                        <li><a href="https://www.linkedin.com/in/julien-michelin-799b982aa" target="_blank" class="text-white-50 text-decoration-none">LinkedIn</a> </li>
                        <li><a href="https://github.com/jujumichl" target="_blank" class="text-white-50 text-decoration-none">GitHub</a> </li>
                    </ul>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-12">
                    <p class="mb-0 text-white-50">Alternance : Septembre 2025 - 2026</p>
                    <p class="mb-0 text-white-50">&copy; 2025 Julien Michelin. Tous droits r√©serv√©s.</p>
                    <a href="./../playground/" class="text-dark small text-decoration-none">playground</a>
                </div>
            </div>
        </div>
    </footer>
    <button type="button" class="btn btn-primary btn-lg rounded-circle shadow scroll-top" id="scrollTopBtn">
        &#x2191;
    </button>
    <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/go.min.js"></script>
    <script>
        hljs.highlightAll();
    </script>
    <script defer src="./../script.js"></script>
</body>
</html>